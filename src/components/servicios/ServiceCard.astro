---
/**
 * ============================================
 * GMEXPRESS - COMPONENTE SERVICE CARD
 * ============================================
 *
 * Tarjeta de servicio que muestra información básica.
 * Los servicios con hasPrice=true pueden agregarse al carrito.
 * Los servicios sin precio redirigen a cotización.
 *
 * Props:
 * - id: ID del servicio en Firestore
 * - name: Nombre del servicio
 * - price: Precio formateado (si aplica)
 * - priceLabel: Etiqueta adicional del precio (ej: "/por almuerzo")
 * - image: URL de la imagen
 * - alt: Texto alternativo
 * - description: Descripción del servicio
 * - hasPrice: Si tiene precio fijo (puede agregarse al carrito)
 */

interface Props {
  id: string; // ID del documento en Firestore
  name: string;
  price?: string;
  priceLabel?: string;
  image: string;
  alt: string;
  description: string;
  hasPrice?: boolean; // Si tiene precio, puede agregarse al carrito
}

const {
  id,
  name,
  price,
  priceLabel,
  image,
  alt,
  description,
  hasPrice = false,
} = Astro.props;
---

<div
  class="group flex flex-col overflow-hidden rounded-xl border border-border-light dark:border-border-dark bg-card-light dark:bg-card-dark shadow-sm transition-all duration-300 hover:shadow-lg hover:-translate-y-1"
  data-service
  data-service-id={id}
  data-has-price={hasPrice ? "true" : "false"}
>
  <div class="relative w-full aspect-[4/3]">
    <div
      class="absolute inset-0 bg-center bg-no-repeat bg-cover transition-transform duration-500 group-hover:scale-110"
      data-alt={alt}
      style={`background-image: url('${image}');`}
    >
    </div>
    <!-- Badge según tipo de servicio -->
    {
      hasPrice ? (
        <div class="absolute top-2 right-2 bg-primary text-white text-xs font-bold px-2 py-1 rounded-full">
          Precio Fijo
        </div>
      ) : (
        <div class="absolute top-2 right-2 bg-secondary text-white text-xs font-bold px-2 py-1 rounded-full">
          Cotizar
        </div>
      )
    }
  </div>
  <div class="p-6 flex flex-col grow">
    <h3
      class="text-xl font-bold text-text-light dark:text-text-dark grow"
      data-service-name
    >
      {name}
    </h3>
    <p class="mt-2 text-sm text-text-light/80 dark:text-text-dark/80 flex-grow">
      {description}
    </p>
    {
      hasPrice && price && (
        <div class="mt-4 mb-2">
          <span
            class="text-2xl font-bold text-text-light dark:text-text-dark"
            data-service-price
          >
            {price}
          </span>
          {priceLabel && (
            <span
              class="text-sm text-text-light/60 dark:text-text-dark/60 ml-1"
              data-price-label
            >
              {priceLabel}
            </span>
          )}
        </div>
      )
    }
    <div class="mt-4 flex gap-3">
      <button
        class="group/btn w-full flex items-center justify-center gap-2 rounded-lg h-10 px-4 border-2 border-primary bg-transparent text-primary text-sm font-semibold leading-normal hover:bg-primary hover:text-white transition-all duration-300 hover:shadow-lg hover:scale-105"
        data-view-detail
      >
        <span class="transition-transform group-hover/btn:scale-110"
          >Ver Detalles</span
        >
        <span
          class="material-symbols-outlined text-sm transition-transform group-hover/btn:rotate-12"
          >visibility</span
        >
      </button>
      {
        hasPrice ? (
          <button
            class="w-full flex cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-white text-sm font-bold tracking-wide hover:bg-primary/90 transition-colors"
            data-add-to-cart
          >
            Agregar
          </button>
        ) : (
          <a
            href={`/solicitud-cotizacion?servicio=${encodeURIComponent(name)}`}
            class="w-full flex cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-white text-sm font-bold tracking-wide hover:bg-primary/90 transition-colors"
          >
            Cotizar
          </a>
        )
      }
    </div>
  </div>
</div>
